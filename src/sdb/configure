#!/bin/sh

if [ $# -ne 0 ]
then
	echo "Usage: $0" >&2
	exit 1
fi

ARCH=$(uname -m)
OS=$(uname -s | tr 'A-Z' 'a-z')

vstr=`${CC:-cc} -v 2>&1`
compiler_is(){
	echo "$vstr" | grep "$1" > /dev/null
	return $?
}

if   compiler_is   gcc; then WARN_FLAGS='-Wno-override-init'
elif compiler_is clang; then WARN_FLAGS='-Wno-initializer-overrides'
fi

if [ $ARCH = amd64 ]
then ARCH=x86_64
fi

if [ "$OS" = darwin ]
then CODESIGN=codesign
else CODESIGN=:
fi

cat > config.mk <<!
OS_NAME = $OS
ARCH = $ARCH
CODESIGN = $CODESIGN
!
