#!/bin/sh

. "$(dirname "$0")/common.sh"

if test $# -ne 1
then
	echo >&2 "Usage: $0 path/to/source"
	exit 1
fi

if type objdump >/dev/null 2>&1
then objdump=objdump
elif type gobjdump >/dev/null 2>&1
then objdump=gobjdump
else
	echo >&2 "$0: no objdump binary found"
	exit 1
fi

if maybe_compile -c -g -- "$@"
then bin="$out"
else bin="$1"
fi

export objdump
bin/debug-scope-dump.pl "$bin" | sort
